---
description: Best practices for uni-app-x
globs: 
alwaysApply: true
---

# Memory Bank

你熟悉 uni-app x框架，擅长编写跨平台且高性能的代码。
uni-app x项目使用UTS语言编写script。 UTS是一种跨平台的强类型语言，类似TS语言但类型要求更加严格。

## Code Style and Structure
    - 简洁易懂，复杂的代码配上中文注释。
    - 严格类型匹配，不使用隐式转换。
    - 不使用变量和函数的声明提升，严格的在清晰的范围内使用变量和函数。
    - 当生成某个平台专用代码时，应使用条件编译进行平台约束，避免干扰其他平台。

## project
    - 遵循uni-app x的项目结构，在正确的目录中放置生成的文件。
    
## page
    - 使用uvue作为页面后缀名，uvue与vue基本类似，但有少量细节差异。
    - 生成的uvue页面放置在项目的pages目录下，生成的页面需要在pages.json中注册。
    - 可滚动内容必须在scroll-view、list-view、waterflow等滚动容器中。如果页面需要滚动，则在页面template的一级子节点放置滚动容器，例如` <scroll-view style="flex:1">`。 此时应在 App 上使用条件编译，例如：`<!-- #ifdef APP --><scroll-view class="container"><!-- #endif -->`。
    - 生成uvue页面时，页面内容需符合uts.mdc、uvue.mdc、ucss.mdc、api.mdc约定的规范。


## Cool Unix 框架规范

本项目使用 Cool Unix 框架进行开发，需遵循以下规范：

### 组件开发规范
- **样式设置**：不要在自定义组件上直接添加 `class` 属性，不同平台存在兼容性问题。推荐使用 `pt` 参数进行样式定制。
- **标签闭合**：所有组件都必须使用双闭合标签格式，例如：`<image></image>`、`<cl-image></cl-image>`，禁止使用单闭合标签如 `<image />`。
- **调用组件方法**：
  - 使用 ref 调用组件内部方法时，类型定义格式必须为：`组件名 + ComponentPublicInstance`
  - 必须使用 `null` 联合类型，例如：`const popupRef = ref<ClPopupComponentPublicInstance | null>(null)`
  - 调用时使用 `!` 操作符确保 ref 已被正确赋值，例如：`popupRef.value!.open()`
  - 避免在页面未完全加载时调用组件方法

### 兼容性开发规范（APP端）
- **函数开发**：
  - 箭头函数不支持可选参数，需要使用普通函数替代
  - 模板中使用导出函数时，注意 `export function` 和 `export const` 的差异
- **样式开发**：
  - APP 端不支持通过父级样式修改控制子元素样式，需要为子元素单独添加响应式类名
  - 为避免鸿蒙平台的渲染异常，建议手动设置过渡属性
- **类型规范**：
  - 在 HBuilder X 4.75 以下版本，v-model 必须使用 `as` 进行类型断言
  - 对于复杂类型的数组，必须明确指定泛型和类型断言
  - UTS 是强类型语言，不允许动态类型转换，即使类型结构相同
  - 严格区分可空和不可空类型，使用 `| null` 或 `?` 定义可空属性
- **条件判断**：
  - null 值判断必须使用严格相等 `===` 或 `!==`
  - 避免使用逻辑或运算符 `||` 进行默认值赋值，应使用明确的 null 检查

### 配置管理规范
- 配置系统采用环境分离的设计模式，支持开发环境和生产环境的独立配置
- 根据 NODE_ENV 自动选择对应环境配置
- H5 端支持代理服务配置，解决跨域问题
- 支持多端适配，可配置小程序、H5 等不同平台的配置差异

### 页面开发规范
- 页面使用 `<cl-page>` 组件包裹，无需手动在最外层包裹 `<scroll-view>`
- 页面参数通过 props 接收，避免使用 onLoad 接口
- 页面底部需要展示按钮等操作区域时，统一使用 `cl-footer` 组件
- 组件开发参考 `/pages/demo` 下的代码示例
- 页面开发参照 `/pages/template` 下的标准模板

## 文档资源

- 官方文档：https://doc.dcloud.net.cn/uni-app-x/
- uniCloud：https://doc.dcloud.net.cn/uniCloud/

- 📖 阅读 [组件文档](https://unix.cool-js.com/src/components/doc.html) 了解可用组件
- 🛠️ 查看 [配置指南](https://unix.cool-js.com/src/guide/config.html) 自定义项目设置
- 🎨 学习 [主题定制](https://unix.cool-js.com/src/introduce/theme.html) 打造独特风格
- 🔧 了解 [兼容问题](https://unix.cool-js.com/src/introduce/help.html) 避免开发陷阱
